---
title: "Demonstrate zone junction"
author: "B. Charnomordic"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: yes
vignette: >
  %\VignetteIndexEntry{zone junction}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r,echo=TRUE,message=FALSE, warning=FALSE}
  library(geozoning)
  library(sp)
  library(fields)
```
This vignette illustrates the junction of 2 zones that do not have a common border but that are close to each other and share the same label. If the junction crosses another zone, it cannot be done.

Step 1
------
A map object is simulated with a Gaussian field and a variogram model. 450 points are randomly allocated on a square field of size 1.Then 1936 points are kriged on a regular grid using inverse distance weighted interpolation. A Delaunay tesselation yields point neighborhood in the sense of Voronoi.

```{r,echo=TRUE,message=FALSE, warning=FALSE,fig.height=10}
  seed=80
  map=genMap(DataObj=NULL,seed=seed,disp=0,krig=2)
# Check the mean and standard deviation of generated data.
  meanvarSimu(map)
```
Step 2
-------
Zoning Z is generated from map and quantile vector. Given a probability vector, a vector of values is obtained using the quantile function.
```{r,echo=TRUE,message=FALSE, warning=FALSE}
   qProb=c(0.5,0.7)
   qq=quantile(map$krigGrid,na.rm=TRUE,prob=qProb)
   ZK=initialZoning(qProb,map) # names(ZK)  "resCrit"  "resDist" "resZ" "cL" "qProb"
   # plot zoning (11 zones in this case)
   K=ZK$resZ
   Z=K$zonePolygone
   plotZ(Z)
   printLabZ(list(K)) # zones 9 to 11 have the same label(1)
```
Step 3: Join zone 9 with another zone near by (zone 10)- both zones have the same label
```{r,echo=TRUE,message=FALSE, warning=FALSE}
   kmi=optiRG(K,map,9,10,disp=1)
   plotZ(kmi$zonePolygone)
  
   
```


# Session informations
```{r session,echo=FALSE,message=FALSE, warning=FALSE}
  sessionInfo()
```

