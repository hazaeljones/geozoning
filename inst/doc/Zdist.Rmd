---
title: "Zoning and distance matrix"
author: "B. Charnomordic"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: yes
vignette: >
  %\VignetteIndexEntry{Zoning and distance matrix}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r,echo=TRUE,message=FALSE, warning=FALSE}
  library(geozoning)
```
This vignette illustrates a simple quantile-based zoning procedure without corrections. It uses the initialZoning function and  shows how to use its output to display zones, distance matrices and zone labels.

A map object is simulated with a Gaussian field. 450 points are randomly allocated on a square field of size 1.Then points are kriged using inverse distance weighted interpolation. A map with 2000 points is produced.

```{r,echo=TRUE,message=FALSE, warning=FALSE,fig.height=10}
 
  seed=80
  map=genMap(DataObj=NULL,seed=seed,disp=FALSE,krig=2)

  # display 2D map
  plotMap(map)

```
Generate zoning Z from map, quantile vector (0.4) and plot zoning (7 zones in this case)

```{r,echo=TRUE,message=FALSE, warning=FALSE}
   ZK=initialZoning(qProb=c(0.4,0.7),map,pErr=0.9,simplitol=1e-3,optiCrit=2,disp=0) # names(Z)  "resCrit"  "resDist" "resZ"
   # initialZoning calls zoneGeneration, calNei, calDistance, calCrit
   # zoneGeneration calls contourAuto
   # contourAuto calls contourLines and extensionLine
   Z=ZK$resZ$zonePolygone
   K=ZK$resZ

   plotZ(Z) #only zones
   # obtain normalized corrected distance matrix
   DC0=ZK$resD$matDistanceCorr
   DC0N=normDistMat(DC0,2)
 
```

```{r,echo=TRUE,message=FALSE, warning=FALSE}
  # more detailed plot
  valRef=quantile(map$krigGrid,na.rm=TRUE,prob=c(0.4,0.7))
  dispZ(map$step,map$krigGrid,zonePolygone=Z,K=K,boundary=map$boundary,nbLvl=0,id=FALSE,mu=2)
  title(paste(" q=[",toString(round(valRef,2)),"]   crit=",round(ZK$resCrit,2),sep=""))
  
  # print zoning labels
  printLabZ(list(ZK$resZ))
  # print zoning surfaces
  printZsurf(ZK$resZ$zonePolygone)
  # print zoning ids
  printZid(ZK$resZ$zonePolygone)
  
```


# Session informations
```{r session,echo=FALSE,message=FALSE, warning=FALSE}
  sessionInfo()
```

